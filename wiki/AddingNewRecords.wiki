#summary Implementation of add functionality
#labels Phase-Implementation

= Introduction =

!DataTables Editable plugin handles adding new records in the table. When user wants to add a new record plugin opens "Add new record" dialog where user can populate details of the new record. Example of the add new record form is shown below:

<img src"http://www.codeproject.com/KB/aspnet/MVC-CRUD-DataTable/datatables_add_new.png" />

When a user submits the changes, plugin creates one AJAX request to the server-side page and if update is successful, a record will be added in the table.

= Client side implementation =

On the client side in the web page should be added following elements:
 * Form that will be used for adding new records
 * Button that will open this form
 * In the plugin configuration should be set what server-side page will handle add new record AJAX call.

== Add new record form ==

To add a new record, a custom form that will be used for entering details of the new record should be added. If id of the form is not explicitly specified in plugin initialization id of the add new record form must be "formAddNewRow". Example of the form is:

{{{
<form id="formAddNewRow" action="#" title="Add new company">
    <input type="hidden" id="id" name="id" value="-1" rel="0" />
    <label for="name">Name</label><input type="text" name="name" id="name" class="required" rel="1" />
    <br />
    <label for="name">Address</label><input type="text" name="address" id="address" rel="2" />
    <br />
    <label for="name">Postcode</label><input type="text" name="postcode" id="postcode"/>
    <br />
    <label for="name">Town</label><input type="text" name="town" id="town" rel="3" />
    <br />
    <label for="name">Country</label><select name="country" id="country">
                                        <option value="1">Serbia</option>
                                        <option value="2">France</option>
                                        <option value="3">Italy</option>
                                        </select>   
    <br />         
</form>

}}}

Confirmation and cancel button do not need to be added in the form - they will be auto-generated by the plugin. When user press confirmation button AJAX request will be sent-to the server-side page, with all values user entered in the form. 
*Make sure that server-side page accepts the same parameters you entered as elements of the form*

Form can have more elements that a table columns. To map the values in the form with the columns in the table, each element that matches the table columns must have a rel attribute. Rel attributes of the elements must match the column positions in the table. If the records is successfully added on the server-side, plugin will take all elements that have rel attribute and place them in the table using the rel attributes as a column positions. In the example above id, name, address and country will be added as cells 0, 1, 2, and 3 in the original table.

== Add new record button ==

The button that will be used for opening add new record form should be added to the page. Any style/class can be added to the button - only requirement is that id of the button should be btnAddNewRow. Example of the button is:

{{{
<button id="btnAddNewRow">Add</button>
}}}


== Setting server-side page ==

In the plugin initialization call should be set parameter sAddURL used to define what server-side page should be used for submitting the add AJAX request. Example of initialization code is shown below:

{{{
$('#myDataTable').dataTable().makeEditable({
                    sAddURL: "/Home/AddData.php"
                }); 
}}}

= Server-side page implementation =

Server side page that handles "add new record" AJAX request should read values from request sent by plugin, add new record and return back id of the record that is created.
If delete fails, this page should return error with some error status. Body of the response will be shown to the user as a error message. 

=Customization=

In the add process following elements can be configured:
 * Default id of the "Add new record" form can be changed
 * Default id of the "Add new record" button can be changed
 * Ok and cancel buttons in the add new record dialog can be customized.

==Specifying id of the add new record form==
By default, and "Add new record" form must have id "formAddNewRow" because plugin tries to find form with that id and show it in the dialog. This might be problem if there are more than one tables in the same page with different "Add new record" forms. In that case there will be collision between these forms because they will have same id.
to avoid this case, in the plugin initialization can be explicitly specified what is a id of the form that will be used for adding new record. Example of the plugin initialization call is:

{{{
$('#myDataTable').dataTable().makeEditable({
                    	sAddNewRowFormId: "formAddNewCompany"
                }); 
}}} 

If plugin is initialized with this call, an "Add new record" form must have an id "formAddNewCompany".

==Specifying an id of the "add new record" button==

By default, id of the button that will be used for opening the form is "btnAddNewRow". In that button anything can be changed except the id of the button. However, if some custom id should be added to the button, this custom id must be sent to the plugin during initialization. Example of the initialization call is shown below:

{{{
$('#myDataTable').dataTable().makeEditable({
            		sAddNewRowButtonId: "btnAddNewCompany"
                }); 
}}}

In this case, add new row button must have a "btnAddNewCompany" id. 

==Specifying ids of the Ok and Cancel buttons in the add new record form==

Confirm and delete buttons in the popup dialog are auto-generated and all necessary events are attached to these buttons. However, they can be customized too. If plugin finds any buttons with ids "btnAddNewRowOk" and "btnAddNewRowCancel" it will not auto-generate buttons and it will attach event handlers to the existing buttons. This could be handy if buttons should be placed on the top of the dialog or some custom text or class should be added to the buttons. Also, ids of buttons can be changed using the following initialization code:

{{{
$('#myDataTable').dataTable().makeEditable({
            		sAddNewRowOkButtonId: "btnAddNewCompanyOk",
            		sAddNewRowCancelButtonId: "btnAddNewCompanyCancel"
                }); 

}}}

This initialization code instructs the plugin to find confirm and delete buttons by these ids instead of the default values. This might be useful if you have more than one "Add new record" form with different buttons on the same page, and each of these pairs of buttons should have different ids.